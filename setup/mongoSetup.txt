use online_entertainment
db.createCollection('user');
db.createCollection('tile');

MATCH (t:TILE), (g:GENERE) WHERE t.id = '5e2dab41ff4be8e3f35caeeb' AND g.name IN ['non-fiction','talk show','feel good'] CREATE (t)-[r:BELONGS_TO ]->(g) RETURN r
MATCH (t:TILE)<-[:WATCHED{like:'false'}]-(u:USER) WITH t, count(u) as total return t.tile , total ORDER BY total desct p

MATCH (t:TILE)<-[:WATCHED{like:'true'}]-(u:USER)
WITH count(t) as total, t,g
ORDER BY total DESC
RETURN t.tile as tile, total


-------- Recomendations query -----------
MATCH (u:USER)-[:PREFERS]->(genere:GENERE)
WITH u, collect(genere.name) AS generes
WHERE u.id = '5e315d4a7334fa1c299c205b'
MATCH (t:TILE)-[:BELONGS_TO]->(g:GENERE)
WHERE g.name IN generes
WITH t , (count(t) * 100) /  3  AS percentage_match
RETURN t.tile AS tile, percentage_match
ORDER BY percentage_match DESC
LIMIT 5